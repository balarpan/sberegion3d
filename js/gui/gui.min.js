"use strict";!function(t){t.fn.extend({focus:function(i){return function(e,n){return"number"==typeof e?this.each(function(){var i=this;setTimeout(function(){t(i).focus(),n&&n.call(i)},e)}):i.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(i){if(void 0!==i)return this.css("zIndex",i);if(this.length)for(var e,n,s=t(this[0]);s.length&&s[0]!==document;){if(e=s.css("position"),("absolute"===e||"relative"===e||"fixed"===e)&&(n=parseInt(s.css("zIndex"),10),!isNaN(n)&&0!==n))return n;s=s.parent()}return 0}})}(jQuery);var GUI=function(t){};GUI.Progress=function(t){this.options=$.extend({step:1,min:0,max:1,domNode:null},t),this.options.domNode=GUI.DOMToObject(this.options.domNode),this.init()},GUI.Progress.prototype={constructor:GUI.Progress,init:function(){this._container=$("<div class='guiProgressCont'><div class='guiProgress'></div></div>"),this._progress=this._container.children().first(),this._current=0,this.options.domNode.append(this._container),this._update()},set:function(t){var i=Number(t);isFinite(i)&&(this._current=GUI.clamp(i,this.options.min,this.options.max)),this._update()},setMinMax:function(t,i){this.options.min=t,this.options.max=i,this._current=GUI.clamp(this._current,t,i),this._update()},inc:function(){this._current+=this.options.step,this._update()},_update:function(){var t=this.options.max-this.options.min,i=this._current-this.options.min,e=this._container.width(),n=GUI.clamp(e*i/t,0,e);this._progress.css("width",parseInt(n)+"px")},show:function(t){this._container.show(t)},hide:function(t){this._container.hide(t)},toggle:function(t){this._container.toggle(t)},destroy:function(){this._progress.remove(),this._container.remove(),this._container=null,this._progress=null}},GUI.Window=function(t){this.container=null,this.mouseMode=null,this.init_opt=$.extend({container:null,headerText:"window header",content:null,width:null,height:null,xPosition:null,yPosition:null,zIndex:null,bShowOnCreate:!0,isCloseable:!0,isResizable:!0,onClose:null,onResizeStart:null,onResizeEnd:null,onResizing:null},t),"string"==typeof this.init_opt.container?this.container=$("#"+this.init_opt.container):"object"!=typeof this.init_opt.container||this.init_opt.container?this.container=$(this.init_opt.container):this.container=$("body"),this.wnd_zIndex=this.init_opt.zIndex||this.container.zIndex()+1,this.init_window()},GUI.Window.prototype={constructor:GUI.Window,init_window:function(){var t=this;this.id=GUI.uuid(),this.close_btn_id=GUI.uuid(),this.wnd_cnt=$("<div class='wnd3d_cnt' id='"+this.id+"'></div>"),this.wnd_header=$("<div class='wnd3d_header_cnt'><div class='wnd3d_header'>"+GUI.htmlEscape(this.init_opt.headerText)+"</div></div>"+(this.init_opt.isCloseable?"<button class='wnd3d_close_btn' type='button' id='"+this.close_btn_id+"'></button>":"")),this.wnd_footer=$("<div class='wnd3d_footer_cnt'></div>"),this.init_opt.isResizable&&(this.wnd_resize_anchor=$("<div class='resize_anchor'></div>"),this.wnd_resize_anchor.mousedown(function(i){t.onResizeMouseDown(i)}),this.wnd_footer.append(this.wnd_resize_anchor)),this.wnd_body=$("<div class='wnd3d_body_cnt'><div class='wnd3d_body'></div></div>"),this.init_opt.content&&this.wnd_body.children(".wnd3d_body").append($(this.init_opt.content)),this.wnd_cnt.css({"z-index":this.wnd_zIndex,position:"absolute"}),this.wnd_header.disableSelection(),this.wnd_cnt.append(this.wnd_header),this.wnd_cnt.append(this.wnd_body),this.wnd_cnt.append(this.wnd_footer),this.wnd_header.mousedown(function(i){t.onHeaderMouseDown(i)}),this.wnd_cnt.css({display:"none"}),"center"===this.init_opt.xPosition&&this.wnd_cnt.css({left:parseInt(this.container.width()/2-this.wnd_cnt.width()/2)+"px"}),"center"===this.init_opt.yPosition&&this.wnd_cnt.css({top:parseInt(this.container.height()/2-this.wnd_cnt.height()/2)+"px"}),"right"===this.init_opt.xPosition&&this.wnd_cnt.css({left:parseInt(this.container.width()-this.wnd_cnt.width())+"px"}),"bottom"===this.init_opt.yPosition&&this.wnd_cnt.css({top:parseInt(this.container.height()-this.wnd_cnt.height())+"px"}),this.container.append(this.wnd_cnt),$("#"+this.close_btn_id).click(function(){t.show(!1)}),this.show(this.init_opt.bShowOnCreate)},show:function(t){t?(this.wnd_cnt.show(300),GUI.shiftToviewport(this.wnd_cnt)):this.wnd_cnt.hide(300)},setMouseMode:function(t){this.mouseMode=t},cleanMouseMode:function(){this.setMouseMode(),$("body").off("mousemove"),$("body").off("mouseup"),this.container.enableSelection(),this.container.get(0).style.cursor="default"},onHeaderMouseDown:function(t){t.stopPropagation(),this.mouse_xdiff=t.pageX-this.wnd_cnt.position().left,this.mouse_ydiff=t.pageY-this.wnd_cnt.position().top;var i=this;this.setMouseMode("header_drag"),$("body").on("mousemove",function(t){i.onMouseMove(t)}),$("body").on("mouseup",function(t){i.onMouseUp(t)}),$(this.container).disableSelection(),this.cWi=this.container.width(),this.cHe=this.container.height(),this.wWi=this.wnd_cnt.width(),this.wHe=this.wnd_cnt.height(),this.container.get(0).style.cursor="move"},onResizeMouseDown:function(t){t.stopPropagation(),this.mouse_xdiff=t.pageX-this.wnd_cnt.width(),this.mouse_ydiff=t.pageY-this.wnd_cnt.height();var i=this;this.setMouseMode("resize_drag"),$("body").on("mousemove",function(t){i.onMouseMove(t)}),$("body").on("mouseup",function(t){i.onMouseUp(t)}),$(this.container).disableSelection(),this.cWi=this.container.width(),this.cHe=this.container.height(),this.wWi=this.wnd_cnt.width(),this.wHe=this.wnd_cnt.height(),"function"==typeof this.init_opt.onResizeStart&&this.init_opt.onResizeStart(t,this)},onMouseMove:function(t){if(this.mouseMode){var i=t.pageX-this.mouse_xdiff,e=t.pageY-this.mouse_ydiff;"header_drag"===this.mouseMode?(i+this.wWi>this.cWi&&(i=this.cWi-this.wWi),e+this.wHe>this.cHe&&(e=this.cHe-this.wHe),i<0&&(i=0),e<0&&(e=0),this.wnd_cnt.css({top:parseInt(e)+"px",left:parseInt(i)+"px"}),GUI.shiftToviewport(this.wnd_cnt)):"resize_drag"===this.mouseMode&&(i<10&&(i=10),e<10&&(e=10),this.wnd_cnt.css({width:parseInt(i)+"px",height:parseInt(e)+"px"}),"function"==typeof this.init_opt.onResizing&&this.init_opt.onResizing(t,this))}},onMouseUp:function(t){this.cleanMouseMode()},onMouseLeave:function(t){this.onMouseUp(t)},destroy:function(){this.setMouseMode(),this.container.get(0).removeChild(this.wnd_cnt.get(0)),this.wnd_cnt=null,this.wnd_header.off(),this.wnd_header=null,this.wnd_body=null},bodyWidth:function(){return this.wnd_body.width()},bodyHeight:function(){return this.wnd_body.height()-20}},GUI.DataGrid=function(t){this.opt=$.extend({container:null,dataSource:null,numRowsPreload:50,cols:[],autoupdateColsWidth:!0,totalRows:0,onClick:null},t),console.assert(this.opt.container,"You must provide DOM container for DataGrid!"),console.assert("function"==typeof this.opt.dataSource,"You must provide dataSource for DataGrid!"),this.opt.container="string"==typeof this.opt.container?$("#"+this.opt.container):$(this.opt.container),this._curRow=0,Object.defineProperty(this,"totalRows",{enumerable:!0,get:function(){return this.opt.totalRows},set:function(t){this.opt.totalRows=t,this.setTotalRows()}}),this.init()},GUI.DataGrid.prototype={constructor:GUI.DataGrid,init:function(){var t=this;this._gridCnt=$("<div class='guiDatagrid_cnt'><div class='guiDatagrid'><div class='guiDatagridHeader_cnt'></div> <div class='guiDatagridBody_cnt'>\t\t\t<TABLE class='guiDatagridBody'><TBODY></TBODY></TABLE></div> </div></div>"),this.opt.container.append(this._gridCnt),this._header=this._gridCnt.find(".guiDatagridHeader_cnt:first"),this.opt.cols.forEach(function(i){var e=GUI.htmlEscape(i.name);t._header.append('<div class="guiDatagridHeader" title="'+e+'">'+e+(i.filter?'<input class="guiDatagridFilter" type="search">':"")+"</div>")}),this._header.append('<div class="guiDatagridHeaderBar" style="visibility:hidden; width:'+GUI.getScrollbarWidthHeight().width+'px;"></div>');var i=this._gridCnt.zIndex()+1;this._busyMsg=$("<div class='guiDatagridBusy'/>").css({zIndex:i,opacity:0}),this._progress=$("<progress class='guiProgressLine guiDatagridLaodingLine'></progress>").css({zIndex:i,opacity:0}),this._header.append(this._progress),this._gridCnt.append(this._busyMsg),this._body=this._gridCnt.find(".guiDatagridBody:first").children("TBODY:first"),this._body.append('<tr class="guiDatagridRow"><td class="guiDatagridCell">&nbsp;</td></tr>'),setTimeout(function(){this._bodyCnt=this._gridCnt.find(".guiDatagridBody_cnt:first").css("height",parseInt(this.opt.container.innerHeight()-this._header.outerHeight(!0))+"px"),t._rowHeight=t._body.children("TR:first").innerHeight(),t._body.children("TR").remove(),t._marginBefore=$('<div class="guiDatagridMargin"/>'),t._marginAfter=$('<div class="guiDatagridMargin"/>'),t._body.parent().before(t._marginBefore),t._body.parent().after(t._marginAfter),t._maxVisible=parseInt(t._bodyCnt.innerHeight()/t._rowHeight),t._header.find("input.guiDatagridFilter").hide(),t.qryTotalRows().then(function(){t._header.find("input.guiDatagridFilter").show().on("change search",t.onFilterChange.bind(t)),t._marginBefore.css("width",t._header.get(0).scrollWidth),t._marginAfter.css("width",t._header.get(0).scrollWidth)}),t._bodyCnt.scroll(t.scrollEvt.bind(t)),"function"==typeof t.opt.onClick&&t._body.click(t.onCellClick.bind(t))}.bind(this),350)},qryTotalRows:function(){var t=this;return t.busyMsg(!0),t.opt.dataSource($.extend(t.buildQry(),{countOnly:!0})).then(function(i){return t.busyMsg(!1),t.totalRows=i,i},function(i){return t.busyMsg(!1),console.error("error getting rows count",i),i})},setTotalRows:function(){this._cache={start:1/0,end:-(1/0),data:[]},this._curRow=0,this._maxLastPage=GUI.clamp(this.totalRows-this._maxVisible,0,this.totalRows),this._view={from:GUI.clamp(this._curRow-this.opt.numRowsPreload,0,this.totalRows),to:GUI.clamp(this._curRow+this._maxVisible+this.opt.numRowsPreload,0,this.totalRows)},this.emptyRowTemplate='<tr class="guiDatagridRow">'+this.opt.cols.map(function(){return'<td class="guiDatagridCell">&nbsp;</td>'}).join("")+"</tr>",this._body.children("TR").remove();for(var t=this._view.from;t<this._view.to;t++)this._body.append(this.emptyRowTemplate);this.updateView({from:1/0,to:-(1/0)}),this.updColsWidth(),this.scrollEvt()},updateMargins:function(){var t=GUI.clamp(this._view.from,0,this._maxLastPage),i=GUI.clamp(this.totalRows-this._view.to,0,this.totalRows);this._marginBefore.css("height",parseInt(t*this._rowHeight+1)+"px"),this._marginAfter.css("height",parseInt(i*this._rowHeight+1)+"px"),this._marginBefore.css("width",this._header.get(0).scrollWidth),this._marginAfter.css("width",this._header.get(0).scrollWidth)},updateView:function(t){var i=this,e=t?t:this._view,n=GUI.clamp(this._curRow+this._maxVisible,0,this.totalRows);if(GUI.clamp(this._curRow,e.from,e.to-1)!==this._curRow||GUI.clamp(n,e.from,e.to-1)!==n){var s=GUI.clamp(this._curRow-this.opt.numRowsPreload,0,this.totalRows),o=GUI.clamp(this._curRow+this._maxVisible+this.opt.numRowsPreload,0,this.totalRows);this._view.from=s,this._view.to=o,this.clampTable(),this.updateMargins();var r=function(t){return i._body.find("TR").each(function(i){$(this).find("TD").each(function(e){this.innerHTML=GUI.htmlEscape(t[i][e])})}),i.updColsWidth(),t};this.validateCache(s,o)?(this.busyMsg(!1),this.qryRows(s,o).done(r)):(this.busyMsg(!0),setTimeout(function(){i._body.find("TD").each(function(){this.innerHTML="&nbsp;"}),i.qryRows(s,o).always(function(t){return i.busyMsg(!1),t}).done(r).fail(function(t){console.error("Error getting DataGrid rows",t)})},20))}},validateCache:function(t,i){return this._cache.start!==1/0&&GUI.clamp(t,this._cache.start,this._cache.end)===t&&GUI.clamp(i,this._cache.start,this._cache.end)===i},wipeCache:function(){this._cache={start:1/0,end:-(1/0),data:[]},this.updateView()},qryRows:function(t,i){var e=this,n=$.Deferred();if(this.validateCache(t,i))n.resolve(this._cache.data.slice(t-this._cache.start,i-this._cache.start));else{var s=GUI.clamp(t-this.opt.numRowsPreload,0,this.totalRows),o=GUI.clamp(i+this.opt.numRowsPreload+this._maxVisible,0,this.totalRows),r=$.extend(e.buildQry(),{from:s,to:o});!function(t,i,e,n,s,o,r,h){t.opt.dataSource(i).then(function(i){return h.from!==t._view.from||h.to!==t._view.to?(r.reject(i),r):(t._cache.start=e,t._cache.end=n,t._cache.data=i,void r.resolve(i.slice(s-e,o-e)))},function(t){r.reject(t)})}(e,r,s,o,t,i,n,this._view)}return n.promise()},scrollEvt:function(){this._header.scrollLeft(this._bodyCnt.scrollLeft()),this.scrollTimer&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(this.scrollEvt_func.bind(this),50)},scrollEvt_func:function(){this._curRow=GUI.clamp(parseInt(this._bodyCnt.scrollTop()/this._rowHeight),0,this._maxLastPage),this.updateView(),this.scrollTimer=null},clampTable:function(t){var i=t?t:this._view,e=this._body.find("TR").length,n=i.to-i.from;if(n===e)return!0;var s=n-e;if(e<n)for(var o=0;o<s;o++)this._body.append(this.emptyRowTemplate);else this._body.find("TR").get().reverse().slice(0,-s).forEach(function(t){$(t).remove()})},updColsWidth:function(t){if(this.opt.autoupdateColsWidth){var i=this,e=this._body.children().first().children(),n=function(n,s){var o=$(e[n]),r=o.width();return i.opt.cols[n].minWidth=i.opt.cols[n].minWidth||$(this).width(),!i.opt.autoupdateColsWidth||t?i.opt.cols[n].minWidth=r:(i.opt.cols[n].minWidth=Math.max(r,i.opt.cols[n].minWidth),o.css("minWidth",i.opt.cols[n].minWidth)),i.opt.cols[n].minWidth+"px"};this._header.children(".guiDatagridHeader").css("width",n)}},buildQry:function(){var t={filters:[],sorting:[]};return this._header.children(".guiDatagridHeader").each(function(){t.filters.push($(this).find(".guiDatagridFilter").first().val())}),t},busyMsg:function(t){var i={opacity:t?1:0};[this._busyMsg,this._progress].forEach(function(t){t.stop().animate(i,750)})},onCellClick:function(t){if(this.opt.onClick&&"TD"===t.target.tagName){t.stopPropagation();var i=t.target.parentNode.rowIndex+this._view.from;return this.opt.onClick(i,t.target.cellIndex,this._cache.data.slice(i-this._cache.start,i-this._cache.start+1),t),t}},onFilterChange:function(t){this.isUpdating||this.qryTotalRows()},clearFilters:function(){this._header.find("input.guiDatagridFilter").filter(function(){return!!this.value}).length&&(this.isUpdating=!0,this._header.find("input.guiDatagridFilter").val(""),this.isUpdating=!1,this.qryTotalRows())},setFiltersVal:function(t){this.isUpdating=!0,this._header.find(".guiDatagridHeader").each(function(i){t.length-1<i||$(this).find("input.guiDatagridFilter").first().val(t[i])}),this.isUpdating=!1,this.qryTotalRows()}},GUI.AttrTable=function(t){var i=this;this.opt=$.extend({urlFC:null,dataSource:this.dataSource.bind(this)},t),QryBuilder.qryJSON(this.opt.urlFC,{}).done(function(t){i.myDataDesc=t,i.myFields=t.fields.filter(function(t){return"esriFieldTypeGeometry"!==t.type}),i.opt.cols=i.myFields.map(function(t){return{name:t.alias.length?t.alias:t.name,filter:"esriFieldTypeDate"!==t.type}}),GUI.DataGrid.call(i,i.opt)}).fail(function(t){console.error("Error reading feature class web-service "+i.opt.urlFC,t)})},GUI.AttrTable.prototype=Object.create(GUI.DataGrid.prototype),GUI.AttrTable.prototype.dataSource=function(t){var i=this,e=$.Deferred(),n=t.filters.map(function(t,e){if(t&&t.length){var n=i.myFields[e],s="esriFieldTypeString"===n.type?"'"+QryBuilder.escapeSQL(t)+"'":QryBuilder.escapeSQL(t),o="=";return 0<=s.indexOf("*")&&("esriFieldTypeString"===n.type?(s="'"+QryBuilder.escapeSQL(t).split("*").join("%")+"'",o=" LIKE "):s=s.split("*").join("")),i.myFields[e].name+o+s}}).filter(function(t){return!!t}).join(" AND ");return n=n.length?n:"1=1",QryBuilder.qryJSON(this.opt.urlFC+"/query",{outFields:"*",returnGeometry:!1,where:n,resultOffset:t.countOnly||t.to-t.from<=0?void 0:t.from,resultRecordCount:t.countOnly||t.to-t.from<=0?void 0:t.to-t.from,returnCountOnly:t.countOnly}).then(function(n){if(t.countOnly)return e.resolve(n.count);var s=i.myFields,o=[];return n.features.forEach(function(t){o.push(s.map(function(i){return t.attributes[i.name]}))}),e.resolve(o)},function(t){e.reject(t)}),e},GUI.PopupMenu=function(t){this.opt=$.extend({items:[],zIndex:999},t),this.init()},GUI.PopupMenu.prototype={constructor:GUI.PopupMenu,init:function(){var t=this;this.menuCnt=$("<div class='guiPopupCont'><ul class='guiPopup'></ul></div>").css({zIndex:this.opt.zIndex,display:"none"}),this.menu=this.menuCnt.children(".guiPopup").first(),this.opt.items.forEach(function(i){var e=$("<li class='guiPopupItem'></ii");t.menu.append(e.append(i.html?$(i.html):GUI.htmlEscape(i.text)))}),$("BODY").append(this.menuCnt)},popup:function(t){this.menuWidth=this.menuCnt.outerWidth(!0),this.menuHeight=this.menuCnt.outerHeight(!0),this.left=t.left,this.top=t.top;var i=window.pageYOffset||document.documentElement.scrollTop+2,e=window.pageXOffset||document.documentElement.scrollLeft+2,n=[e,i,GUI.viewportWidth()+e-2,GUI.viewportHeight()+i-2],s=GUI.shiftBoxToParent(this.getMenuBox(),n);this.left=s[0],this.top=s[1],this.menuCnt.css({top:this.top,left:this.left}).show(),$(window).on("click mousewheel scroll keydown","",this.clickHandler.bind(this))},hide:function(){$(window).off("click mousewheel scroll","",this.clickHandler.bind(this)),this.menuCnt.hide()},clickHandler:function(t){if("click"===t.type&&GUI.isPntInBox([t.pageX,t.pageY],this.getMenuBox())){var i=$(t.target).closest("LI.guiPopupItem");if(i.length){var e=this.opt.items[$(i[0]).index()];this.hide(),e.onClick&&e.onClick(t)}}else this.hide()},getMenuBox:function(){return[this.left,this.top,this.left+this.menuWidth,this.top+this.menuHeight]}},GUI.Carousel=function(t){this._opt=$.extend({dom_container:null,id:null,orientation:"vertical",itemCSS:"",mouseWheelMultiply:1,onClick:null},t),this._opt.type="vertical"===this._opt.orientation?"vert":"horiz",this._opt.typeCSS=(this._opt.itemCSS.length>0?this._opt.itemCSS+" ":"")+this._opt.type,this._opt.id||(this._opt.id=GUI.uuid()),this.build()},GUI.Carousel.prototype={constructor:GUI.Carousel,build:function(){var t=GUI.DOMToObject(this._opt.dom_container),i=$('<div class="Carousel3dcnt '+this._opt.type+'" id="'+this._opt.id.toString()+'"><div class="Carousel3d '+this._opt.type+'"></div></div>');i.disableSelection(),null!==t&&t.append(i),this._dom=i.children().first(),this.bindEvents()},bindEvents:function(){this._dom.on("mousewheel",this.onMouseWheel.bind(this))},unbindEvents:function(){this._dom.off()},onMouseWheel:function(t){var i=t.deltaFactor*t.deltaY*this._opt.mouseWheelMultiply;this.scrollBy(0-i)},scrollBy:function(t){if(0!==t){this._dom.stop(!0);var i=this.isVertical,e=i?this._dom.parent().height():this._dom.parent().width(),n=i?0-parseInt(this._dom.css("top")):0-parseInt(this._dom.css("left")),s=i?this._dom.height():this._dom.get(0).scrollWidth,o=parseInt(GUI.clamp(n+t,0,s-e));if(o-=n,0!==o){var r=i?{top:"-="+o+"px"}:{left:"-="+o+"px"};this._dom.animate(r,{duration:parseInt(Math.abs(o)/1200*1e3),queue:!1,easing:"linear"})}}},addItem:function(t,i){var e=this,n=$(t),s=$('<div class="Carousel3dItem inactive '+this._opt.typeCSS+'">');s.click(e.itemClick.bind(e)),this._dom.append(s.append(n));var o=this._dom.children().length-1;return s.data({num:o,userData:i}),o},itemClick:function(t){t.preventDefault();var i=$(t.delegateTarget);this.selectItem(i.data().num),"function"==typeof this._opt.onClick&&this._opt.onClick.call(this,t,i.data().userData)},selectItem:function(t){if(!(0>t||t>this.itemsCount-1)){var i=this,e=this.isVertical;this._dom.stop(!0);var n=this.getItem(t),s=(n.data().num+1,e?this._dom.parent().height():this._dom.parent().width()),o=e?n.outerHeight():n.outerWidth();o+=e?parseInt(n.css("margin-bottom"))+parseInt(n.css("margin-top")):parseInt(n.css("margin-left"))+parseInt(n.css("margin-right"));var r=e?n.position().top:n.position().left,h=e?0-parseInt(i._dom.css("top")):0-parseInt(i._dom.css("left")),a=h+s/2,c=r-a+o/2,d=e?this._dom.height():this._dom.get(0).scrollWidth;if(this._dom.children().removeClass("active").addClass("inactive"),n.removeClass("inactive").addClass("active"),h+c>d-s&&(c=d-s-h),h+c<0&&(c=0-h),c=parseInt(c),o<s){var l=e?{top:"-="+c+"px"}:{left:"-="+c+"px"};this._dom.animate(l,{duration:parseInt(Math.abs(c)/300*1e3)+parseInt(50/Math.abs(c)*1e3),queue:!1})}}},getItem:function(t){return $(this._dom.children()[t])},getUserData:function(t){return this.getItem(t).data().userData},get isVertical(){return"vert"===this._opt.type},get itemsCount(){return this._dom.children().length}},GUI.Gradient=function(t){this._opt=$.extend({colorStart:"#000000",colorEnd:"#ffffff"},t),this.build()},GUI.Gradient.prototype={constructor:GUI.Carousel,build:function(){this._opt.startRGB=this.convertToRGB(this._opt.colorStart),this._opt.endRGB=this.convertToRGB(this._opt.colorEnd)},getHexColor:function(t){return this.convertToHex(this.getRGBColor(t))},getRGBColor:function(t){var i=[];return i[0]=parseInt(this._opt.startRGB[0]*t+(1-t)*this._opt.endRGB[0]),i[1]=parseInt(this._opt.startRGB[1]*t+(1-t)*this._opt.endRGB[1]),i[2]=parseInt(this._opt.startRGB[2]*t+(1-t)*this._opt.endRGB[2]),i},getRGBstring:function(t){var i=this.getRGBColor(t);return"rgb("+i.join(",")+")"},trim:function(t){return"#"==t.charAt(0)?t.substring(1,7):t},convertToRGB:function(t){var i=[];return i[0]=parseInt(this.trim(t).substring(0,2),16),i[1]=parseInt(this.trim(t).substring(2,4),16),i[2]=parseInt(this.trim(t).substring(4,6),16),i},convertToHex:function(t){return this.hex(t[0])+this.hex(t[1])+this.hex(t[2])},hex:function(t){var i="0123456789abcdef",e=parseInt(t);return 0==e||isNaN(t)?"00":(e=Math.round(Math.min(Math.max(0,e),255)),i.charAt((e-e%16)/16)+i.charAt(e%16))}},GUI.nextID=0,GUI.script_folder=null,GUI.uuid=function(){return GUI.nextID+=1,"gui"+GUI.nextID.toString(32)},GUI.clamp=function(t,i,e){return Math.max(i,Math.min(e,t))},GUI.isPntInBox=function(t,i){return t[0]>=i[0]&&t[0]<=i[2]&&t[1]>=i[1]&&t[1]<=i[3]},GUI.shiftBoxToParent=function(t,i){if(GUI.isPntInBox(t.slice(0,2),i)&&GUI.isPntInBox(t.slice(2,4),i))return t;var e=t.slice(),n=function(t,i){var n=i?0:1;e[0+n]+=t,e[2+n]+=t};return e[2]>i[2]&&n(i[2]-e[2],!0),e[0]<i[0]&&n(i[0]-e[0],!0),e[3]>i[3]&&n(i[3]-e[3],!1),e[1]<i[1]&&n(i[1]-e[1],!1),e},GUI.shiftToviewport=function(t){var i=GUI.DOMToObject(t),e=window.pageYOffset||document.documentElement.scrollTop+2,n=window.pageXOffset||document.documentElement.scrollLeft+2,s=[n,e,GUI.viewportWidth()+n-2,GUI.viewportHeight()+e-2],o=i.offset().left,r=i.offset().top,h=[o,r,o+i.outerWidth(!0),r+i.outerHeight(!0)],a=GUI.shiftBoxToParent(h,s);i.css({left:a[0],top:a[1]})},GUI.viewportWidth=function(){return $("body").prop("clientWidth")},GUI.viewportHeight=function(){return $("body").prop("clientHeight")},GUI.getScrollbarWidthHeight=function(){if(GUI.getScrollbarWidthHeight.result)return GUI.getScrollbarWidthHeight.result;var t=document.createElement("div");return t.style.overflow="scroll",t.style.visibility="hidden",t.style.position="absolute",t.style.width="100px",t.style.height="100px",document.body.appendChild(t),GUI.getScrollbarWidthHeight.result={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight},t.parentNode.removeChild(t),GUI.getScrollbarWidthHeight.result},GUI.htmlEscape=function(t){return $("<div />").text(t).html()},GUI.DOMToObject=function(t){var i;return i="string"==typeof t?$("#"+t):t instanceof jQuery?t:"object"==typeof t&&t.nodeType?$(t):document.body},GUI.preloadImage=function(t){try{var i=new Image;i.src=t}catch(t){}},GUI.log=function(){console.log.apply(console,arguments)},GUI.warn=function(){console.warn.apply(console,arguments)},GUI.error=function(){console.error.apply(console,arguments)},GUI.debug=function(){console.debug.apply(console,arguments)},function(t){var i={plugins:{jQueryMousewheel:{credits:"https://github.com/jquery/jquery-mousewheel",folder:"mousewheel",js:["jquery.mousewheel.js","mwheelIntent.js"],css:[]}}},e=i;GUI.script_folder=null,GUI.script_node=null;var n=document.getElementsByTagName("script");if(n&&n.length>0)for(var s in n)if(n[s].src&&n[s].src.match(new RegExp("gui/gui(?:\\.min)?\\.js"))){GUI.script_folder=n[s].src.substr(0,n[s].src.lastIndexOf("/")+1),GUI.script_node=t(n[s]);break}if(!GUI.script_folder)return void GUI.error("Can't find script tag in HTML Head which referres to gui.js!");var o=["gui.css"],r=[];for(var h in e.plugins){var a=e.plugins[h];o=o.concat(a.css.map(function(t){return a.folder+"/"+t})),r=r.concat(a.js.map(function(t){return a.folder+"/"+t})),GUI.log("GUI. Loading plugin "+h+"."," Credits: "+a.credits)}o.forEach(function(t){var i=document.createElement("link");i.rel="stylesheet",i.href=GUI.script_folder+t,i.media="screen",document.getElementsByTagName("head")[0].appendChild(i)});r.forEach(function(t){var i=document.createElement("script");i.type="text/javascript",i.src=GUI.script_folder+t,i.async=!1,document.getElementsByTagName("head")[0].appendChild(i)})}(jQuery);